<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE Map[]>
<Map srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
  <Parameters>
    <Parameter name="name"><![CDATA[OpenStreetMap en catalÃ  - control layer]]></Parameter>
    <Parameter name="description"><![CDATA[A general-purpose OpenStreetMap mapnik style, focused on minored langages, in CartoCSS]]></Parameter>
    <Parameter name="attribution"><![CDATA[CC-BY-SA OSM-BZH]]></Parameter>
    <Parameter name="scale">1</Parameter>
    <Parameter name="metatile">2</Parameter>
    <Parameter name="bounds">-180,-85,180,85</Parameter>
    <Parameter name="center">-2.96,48.03,8</Parameter>
    <Parameter name="format"><![CDATA[png]]></Parameter>
    <Parameter name="minzoom">4</Parameter>
    <Parameter name="maxzoom">18</Parameter>
  </Parameters>
  <Layer name="land_high" srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over" status="on">
    <Datasource>
      <Parameter name="file"><![CDATA[/data/styles/data/land-polygons-split-3857/land_polygons.shp]]></Parameter>
      <Parameter name="type"><![CDATA[shape]]></Parameter>
    </Datasource>
  </Layer>
  <Style filter-mode="first" name="places">
    <Rule>
      <MaxScaleDenominator>50000</MaxScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <MarkersSymbolizer fill="#a90825" stroke-opacity="0.75" width="10" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>100000</MaxScaleDenominator>
      <MinScaleDenominator>50000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <MarkersSymbolizer fill="#a90825" stroke-opacity="0.6" width="8" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>200000</MaxScaleDenominator>
      <MinScaleDenominator>100000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <MarkersSymbolizer fill="#a90825" stroke-opacity="0.3" width="6" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>400000</MaxScaleDenominator>
      <MinScaleDenominator>200000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <MarkersSymbolizer fill="#a90825" stroke-opacity="0" width="4" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>750000</MaxScaleDenominator>
      <MinScaleDenominator>400000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <MarkersSymbolizer fill="#a90825" stroke-opacity="0" width="2" />
    </Rule>
    <Rule>
      <MinScaleDenominator>750000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <MarkersSymbolizer fill="#a90825" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>50000</MaxScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <MarkersSymbolizer fill="#3d9733" stroke-opacity="0.75" width="10" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>100000</MaxScaleDenominator>
      <MinScaleDenominator>50000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <MarkersSymbolizer fill="#3d9733" stroke-opacity="0.6" width="8" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>200000</MaxScaleDenominator>
      <MinScaleDenominator>100000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <MarkersSymbolizer fill="#3d9733" stroke-opacity="0.3" width="6" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>400000</MaxScaleDenominator>
      <MinScaleDenominator>200000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <MarkersSymbolizer fill="#3d9733" stroke-opacity="0" width="4" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>750000</MaxScaleDenominator>
      <MinScaleDenominator>400000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <MarkersSymbolizer fill="#3d9733" stroke-opacity="0" width="2" />
    </Rule>
    <Rule>
      <MinScaleDenominator>750000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <MarkersSymbolizer fill="#3d9733" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>50000</MaxScaleDenominator>
      <MarkersSymbolizer stroke-opacity="0.75" width="10" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>100000</MaxScaleDenominator>
      <MinScaleDenominator>50000</MinScaleDenominator>
      <MarkersSymbolizer stroke-opacity="0.6" width="8" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>200000</MaxScaleDenominator>
      <MinScaleDenominator>100000</MinScaleDenominator>
      <MarkersSymbolizer stroke-opacity="0.3" width="6" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>400000</MaxScaleDenominator>
      <MinScaleDenominator>200000</MinScaleDenominator>
      <MarkersSymbolizer stroke-opacity="0" width="4" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>750000</MaxScaleDenominator>
      <MinScaleDenominator>400000</MinScaleDenominator>
      <MarkersSymbolizer stroke-opacity="0" width="2" />
    </Rule>
  </Style>
  <Layer maximum-scale-denominator="750000" name="places" srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over" status="on">
    <StyleName><![CDATA[places]]></StyleName>
    <Datasource>
      <Parameter name="type"><![CDATA[postgis]]></Parameter>
      <Parameter name="dbname"><![CDATA[osm]]></Parameter>
      <Parameter name="key_field"><![CDATA[]]></Parameter>
      <Parameter name="geometry_field"><![CDATA[way]]></Parameter>
      <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
      <Parameter name="host"><![CDATA[db.openstreetmap.world]]></Parameter>
      <Parameter name="user"><![CDATA[osmbr]]></Parameter>
      <Parameter name="password"><![CDATA[m4d31nbr31zh]]></Parameter>
      <Parameter name="asynchronous_request">true</Parameter>
      <Parameter name="max_async_connection">4</Parameter>
      <Parameter name="max_size">50</Parameter>
      <Parameter name="cursor_size">5000</Parameter>
      <Parameter name="table"><![CDATA[(SELECT 
  a.osm_id, a.name, b.local_name,
  CASE
    WHEN b.local_name IS NULL THEN 'null'
    ELSE 'done'
  END AS check,
  a.way 
FROM planet_osm_point a
FULL JOIN 
(
  SELECT osm_id, tags -> 'name:ca' AS local_name
  FROM planet_osm_point 
  WHERE (tags -> 'name:ca'::text IS NOT NULL)
) AS b ON a.osm_id = b.osm_id
WHERE name IS NOT NULL AND place IS NOT NULL
) AS places]]></Parameter>
    </Datasource>
  </Layer>
  <Style filter-mode="first" name="ways">
    <Rule>
      <MaxScaleDenominator>50000</MaxScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <LineSymbolizer stroke="#a90825" stroke-width="2.5" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>100000</MaxScaleDenominator>
      <MinScaleDenominator>50000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <LineSymbolizer stroke="#a90825" stroke-width="1.5" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>200000</MaxScaleDenominator>
      <MinScaleDenominator>100000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <LineSymbolizer stroke="#a90825" stroke-width="1" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>400000</MaxScaleDenominator>
      <MinScaleDenominator>200000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <LineSymbolizer stroke="#a90825" stroke-width="0.5" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>750000</MaxScaleDenominator>
      <MinScaleDenominator>400000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <LineSymbolizer stroke="#a90825" stroke-width="0.2" />
    </Rule>
    <Rule>
      <MinScaleDenominator>750000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'null')]]></Filter>
      <LineSymbolizer stroke="#a90825" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>50000</MaxScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <LineSymbolizer stroke="#3d9733" stroke-width="2.5" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>100000</MaxScaleDenominator>
      <MinScaleDenominator>50000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <LineSymbolizer stroke="#3d9733" stroke-width="1.5" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>200000</MaxScaleDenominator>
      <MinScaleDenominator>100000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <LineSymbolizer stroke="#3d9733" stroke-width="1" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>400000</MaxScaleDenominator>
      <MinScaleDenominator>200000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <LineSymbolizer stroke="#3d9733" stroke-width="0.5" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>750000</MaxScaleDenominator>
      <MinScaleDenominator>400000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <LineSymbolizer stroke="#3d9733" stroke-width="0.2" />
    </Rule>
    <Rule>
      <MinScaleDenominator>750000</MinScaleDenominator>
      <Filter><![CDATA[([check] = 'done')]]></Filter>
      <LineSymbolizer stroke="#3d9733" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>50000</MaxScaleDenominator>
      <LineSymbolizer stroke-width="2.5" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>100000</MaxScaleDenominator>
      <MinScaleDenominator>50000</MinScaleDenominator>
      <LineSymbolizer stroke-width="1.5" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>200000</MaxScaleDenominator>
      <MinScaleDenominator>100000</MinScaleDenominator>
      <LineSymbolizer stroke-width="1" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>400000</MaxScaleDenominator>
      <MinScaleDenominator>200000</MinScaleDenominator>
      <LineSymbolizer stroke-width="0.5" />
    </Rule>
    <Rule>
      <MaxScaleDenominator>750000</MaxScaleDenominator>
      <MinScaleDenominator>400000</MinScaleDenominator>
      <LineSymbolizer stroke-width="0.2" />
    </Rule>
  </Style>
  <Layer maximum-scale-denominator="750000" name="ways" srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over" status="on">
    <StyleName><![CDATA[ways]]></StyleName>
    <Datasource>
      <Parameter name="type"><![CDATA[postgis]]></Parameter>
      <Parameter name="dbname"><![CDATA[osm]]></Parameter>
      <Parameter name="key_field"><![CDATA[]]></Parameter>
      <Parameter name="geometry_field"><![CDATA[way]]></Parameter>
      <Parameter name="extent"><![CDATA[-20037508,-20037508,20037508,20037508]]></Parameter>
      <Parameter name="host"><![CDATA[db.openstreetmap.world]]></Parameter>
      <Parameter name="user"><![CDATA[osmbr]]></Parameter>
      <Parameter name="password"><![CDATA[m4d31nbr31zh]]></Parameter>
      <Parameter name="asynchronous_request">true</Parameter>
      <Parameter name="max_async_connection">4</Parameter>
      <Parameter name="max_size">50</Parameter>
      <Parameter name="cursor_size">5000</Parameter>
      <Parameter name="table"><![CDATA[(SELECT 
  a.osm_id, a.name, b.local_name,
  CASE
      WHEN b.local_name IS NULL THEN 'null'
      ELSE 'done'
  END AS check,
  a.way 
FROM planet_osm_line a
FULL JOIN 
(
    SELECT osm_id, tags -> 'name:ca' AS local_name
    FROM planet_osm_line 
    WHERE (tags -> 'name:ca'::text IS NOT NULL)
) AS b ON a.osm_id = b.osm_id
WHERE name IS NOT NULL AND highway IS NOT NULL
) AS ways]]></Parameter>
    </Datasource>
  </Layer>
</Map>

